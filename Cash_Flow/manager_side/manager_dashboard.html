<html>
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Project S Manager</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:ital,wght@0,100..900;1,100..900&family=Roboto:ital,wght@0,100..900;1,100..900&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="manager_dashboard.css">
  </head> 
  <body>
    <div class="main-grid">
      <div class="navigation-bar">
        <nav>
          <div class="left-contents"></div>
          <div class="middle-contents">
            <h1 class="web-title">Project S</h1>
          </div>
          <div class="right-contents">
            <img src="/Portfolio_project/images/lug.jpg" alt="pfp" class="manager-pfp">
          </div>
        </nav>
      </div>
      <div class="side-bar">
        <!-- This section would display the customers with inquiries or concerns --> 
        <!-- The side bar here will be similar to the messenger side bar  -->
        <div class="customer-messages-panel">
          <input type="search" name="search" id="customer-search">
          <div class="customers">
            <!-- the contents here for now is static but it should display the customers with inquiries, with the new messages being on top for attentio like on Messenger -->
            <img src="/Major-Projects/Cash_Flow/projectS_images/no-profile.jpg" alt="" class="profile-customer">
            <div class="customer-profile-info">
              <!-- This section here is also just for placeholder, I'll add the dynamic version hopefully by july -->
              <h3 class="name-of-customer">Juan Dela Cruz</h3>
              <p class="recent-message">What's my update?</p>
            </div>
          </div>
        </div>
      </div>
      <div class="separator">
        <div class="main-contents">
          <div class="nav-main-contents">
            <ul class="nav-ul">
              <li class="nav-li"><a href="#" class="options" id="customer-id">Customer</a></li>
              <li class="nav-li"><a href="#" class="options" id="cashflow-id">Cashflow</a></li>
              <li class="nav-li"><a href="#" class="options" id="chat-id">Chat</a></li>
            </ul>
          </div>
          <main>
            <div id="customer" class="tab-pane">

              <!-- Add the dynamic customer info here -->

            </div>
            <!-- Display none for now, the logic will be added when learning javascript -->
            <div id="cashflow" class="tab-pane">
             <div class="table-position">
              <div class="total-contain">
                <h2 class="total-display">Initial</h2>
                <input type="number" class="number-input" min="0" id="initial-state">
              </div>
              <table>
                <thead>
                  <tr>
                    <th>Date</th>
                    <th>Description</th>
                    <th>In</th>
                    <th>Out</th>
                    <th>Output</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><input class="table-input" type="date" name="date" id="date"></td>
                    <td><textarea class="table-input" name="description" id="description"></textarea></td>
                    <td><input data-type="in" class="table-input"type="number" min="0"></td>
                    <td><input type="number" class="table-input" data-type="out" min="0"></td>
                    <td><output data-type="output" class="table-input">0</output></td>
                  </tr>
                </tbody>
              </table>
              <div class="total-contain">
                <h2 class="total-display">Total</h2>
                <output id="total-val">0</output>
              </div>
              <div class="add-container">
                  <button class="add-rows">Add row</button>
              </div>
             </div> 
            </div>
            <div id="chat" class="tab-pane">
              <div class="chat-panel">
                <div class="chat-messages">
                  <p style="color: white; padding: 10px; margin: 0px;">Hello How are you?</p>
                </div>
                <div class="message-section">
                  <textarea name="chats" id="chats" class="chats"></textarea>
                </div>
              </div>
            </div>
          </main>
        </div>
        <div class="deadlines">
          <div class="nav-dl">
            <h2 class="due-this-week">
              Due This Week
            </h2>
          </div>
          <!-- This section here is also just for placeholder, I'll add the dynamic version hopefully by july -->
        </div>
      </div>
    </div>
    <!-- This button upon clicking will show a modal that contains a form that will include the sizes, type of fabric, and their info and requests -->
    <button class="add-customer">
      <span class="plus-icon">+</span>
      <span class="button-text">Add Customer</span>
    </button>

       <!-- Display: none; for now  -->
    <div class="modal-overlay">
    <div class="modal-container">
      <img src="/Major-Projects/Cash_Flow/projectS_images/unif.jpg" alt="uniform_type" class="unif-pic-type"> <!-- Placeholder for now, will start implementing a dynamic version, while learning javascript -->
      <div class="info-panel">
        <div class="top-info-panel"> <!-- top position -->
          <div class="left-info">

            <!-- Place the customer info here -->

          </div>
          <div class="right-info">

            <!-- Place the order date here -->

          </div>
        </div>
        <div class="mid-info-panel">
          <div class="mid-info-upper">
            <div class="mid-info-left">
                <select name="status-update" id="status-dropdown" class="status-update-dropdown">
                <option value="not-started">Not Started</option>
                <option value="started">Started</option>
                <option value="in-progress">In progress</option>
                <option value="ready">Ready</option>
              </select>
            </div>
            <div class="mid-info-right">
              <div class="set-wrapper">

              </div>
              <select name="order-type" id="order-type" class="order-type">
                <option value="Short Sleeve">Short Sleeve</option>
                <option value="Long Sleeve">Long Sleeve</option>
                <option value="Pants">Pants</option><!-- 7 inputs here on pants -->
              </select>
            </div>
          </div>
          <div class="sizes-form"> <!--Grid possible here-->
            <div class="grid-box-one">

            </div>
            <div class="grid-box-two">

            </div>
            <div class="grid-box-three">
              <p class="remarks">Remarks:</p>
              <textarea name="request" id="requests"></textarea>
            </div>
            <div class="footer-grid">
              <div class="empty"></div>
              <button class="submit-save">Done</button>
            </div>
          </div>
        </div>
      <div class="progress-bar-contain">
        <div class="status-title">
          <h2 class="status">Started</h2>
          <h2 class="status">In progress</h2>
          <h2 class="status">Ready</h2>
        </div>
      <div class="progress-bar"></div>
      </div>
      </div>
    </div>
    </div>

    <!-- Confirmation modal -->
    <div class="modal-overlay" id="confirmation">
      <div class="modal-confirmation">
        <div class="top-confirm">
          <h2 class="header-confirm">
            Tag Update!!
          </h2>
        </div>
        <div class="middle-confirm">
          <h3 class="sub-header">
            Is the product<br>already in progress or ready?
          </h3>
        </div>
        <div class="lower-confirm">
          <button class="no">No</button>
          <button class="confirm-modal">Yes</button>
        </div>
      </div>
    </div>
  </body>
  <script>

    // 7/22/2025 - Navigation bar/Switching panels

    // panel switching 
    let mainContents = document.querySelector(".main-contents");

    // nav-bar 
    let customerId = document.getElementById("customer-id");
    let cashflowId = document.getElementById("cashflow-id");
    let chatId = document.getElementById("chat-id");

    // panels 
    let customerPanel = document.getElementById("customer"); // append the customer data
    let cashflowPanel = document.getElementById("cashflow");
    let chatPanel = document.getElementById("chat");

    mainContents.addEventListener("click", function(event) {
      let action = event.target.id;

      // navigating through the main contents
      if(action === "customer-id") {
        customerId.style.backgroundColor = "grey";
        customerPanel.style.display = "flex";

        cashflowId.style.backgroundColor = "";
        cashflowPanel.style.display = "none";

        chatId.style.backgroundColor = "";
        chatPanel.style.display = "none";
      } else if (action === "cashflow-id") {
        cashflowId.style.backgroundColor = "grey";
        cashflowPanel.style.display = "flex";

        customerId.style.backgroundColor = "";
        customerPanel.style.display = "none";

        chatId.style.backgroundColor = "";
        chatPanel.style.display = "none"
      } else if (action === "chat-id") {
        chatId.style.backgroundColor = "grey";
        chatPanel.style.display = "flex";

        cashflowId.style.backgroundColor = "";
        cashflowPanel.style.display = "none";

        customerId.style.backgroundColor = "";
        customerPanel.style.display = "none"
      }

     })

    // making the progress panel dynamic
    let deadline = document.querySelector(".deadlines"); // append the dueDisplay

    // Customer data (JavaScript for now)
    let customerOrders = [
  {
    name: "Juan Dela Cruz",
    contact: "09223457281",
    email: "juan.delacruz@example.com",
    status: "not-started",
    dateOfPurchase: "6/12/2025",
    orderSet: 2,
    orderType: "TTMD",
    order1: "Pants",
    order2: "Long Sleeve",
    dueDate: "",
    order1Measurement: {
      crotch: 2,
      length: 40,
      Waistline: 34,
      Hips: 38,
      thigh: 20,
      knee: 16,
      bottom: 14
    },
    order2Measurement: {
      shoulder: 17,
      sleeveLength: 23,
      cuff: 11,
      ArmHole: 10,
      length: 32,
      bust: 10,
      waistline: 30,
      hips: 36,
      collar: 16
    }
  },

  {
    name: "Maki The Rapper",
    contact: "09223457282",
    email: "maki.therapper@example.com",
    status: "not-started",
    dateOfPurchase: "7/1/2025",
    orderSet: 2,
    orderType: "Uniform",
    order1: "Short Sleeve",
    order2: "Pants",
    dueDate: "",
    order1Measurement: {
      shoulder: 16,
      sleeveLength: 22,
      sleeveOpening: 10,
      ArmHole: 15,
      length: 30,
      Bust: 12,
      waistline: 31,
      hips: 37,
      collar: 15
    },
    order2Measurement: {
      crotch: 10,
      length: 38,
      Waistline: 33,
      Hips: 37,
      thigh: 21,
      knee: 17,
      bottom: 13
    }
  },

  {
    name: "Likitung",
    contact: "09223457283",
    email: "likitung@example.com",
    status: "not-started",
    dateOfPurchase: "7/27/2025",
    orderSet: 0,
    orderType: "Uniform",
    order1: "Short Sleeve",
    order2: "",
    dueDate: "",
    order1Measurement: {
      shoulder: 15,
      sleeveLength: 21,
      sleeveOpening: 9,
      ArmHole: 12,
      length: 28,
      Bust: 10,
      waistline: 29,
      hips: 35,
      collar: 14
    }
  }
];

     
    for(let i = 0; i < customerOrders.length; i++) {

      let convertToDate = new Date(customerOrders[i].dateOfPurchase);

      convertToDate.setDate(convertToDate.getDate() + 7); // formula for setting a due date for an order

      let month = convertToDate.getMonth() + 1; 
      let day = convertToDate.getDate();
      let year = convertToDate.getFullYear();

      let dueDateStr = `${month}/${day}/${year}`;

      customerOrders[i].dueDate = dueDateStr;

      let orderContain = document.createElement("div");
      orderContain.className = "customer-name-order";

      let customerInfo = document.createElement("h3");
      customerInfo.className = "customer-info";
      customerInfo.textContent = `${customerOrders[i].orderType}`;

      let progressTrack = document.createElement("div");
      progressTrack.className = "progress-track";
      customerInfo.textContent = `${customerOrders[i].orderType}`;

      let progressDisplay = document.createElement("div");
      progressDisplay.className = "progress-display";
      progressDisplay.textContent = `${customerOrders[i].status}`;

      let dueDateDisplay = document.createElement("div");
       dueDateDisplay.id = "due-display";

      orderContain.appendChild(customerInfo); 
      progressTrack.appendChild(progressDisplay);
      orderContain.appendChild(progressTrack)
      customerPanel.appendChild(orderContain);

      let due = new Date(customerOrders[i].dueDate);

      let today = new Date();

      let timeDiff = due - today;

      let dayDiff = Math.ceil(timeDiff / (1000*60*60*24));

      if(dayDiff <= 3 && dayDiff >= 0) {
        dueDateDisplay.appendChild(orderContain);
        deadline.appendChild(dueDateDisplay);
      } 

     // customer modal popup
     let customerModal = document.querySelector(".modal-overlay")

    orderContain.addEventListener("click", () => {
     customerModal.style.display = "flex";

    let progressDisplay = orderContain.querySelector(".progress-display");
    let progressTrack = orderContain.querySelector(".progress-track");

    let progressBar = document.querySelector(".progress-bar");
    let currentStatus = customerOrders[i].status
    progressBarLogic(currentStatus, progressBar)

    // customer modal (left-side upper)
     let leftInfo = document.querySelector(".left-info");
     leftInfo.innerHTML = "";

     let customerName = document.createElement("h2");
     customerName.className = "customer-name";
     customerName.textContent = `${customerOrders[i].name}`
     
     let customerCredentials = document.createElement("p");
     customerCredentials.className = "customer-credentials";
     customerCredentials.textContent = `${customerOrders[i].contact}`;

     let customerEmail = document.createElement("p");
     customerEmail.className = "customer-credentials";
     customerEmail.textContent = `${customerOrders[i].email}`;
     
     leftInfo.appendChild(customerName);
     leftInfo.appendChild(customerCredentials);
     leftInfo.appendChild(customerEmail);

     // right-side upper
     let rightInfo = document.querySelector(".right-info");
     rightInfo.innerHTML = "";

     let dateOrdered = document.createElement("h2");
     dateOrdered.className = "date-ordered";
     dateOrdered.textContent = "Ordered In:";

     let date = document.createElement("p");
     date.className = "date";
     date.textContent = `${customerOrders[i].dateOfPurchase}`;
      
     rightInfo.appendChild(dateOrdered);
     rightInfo.appendChild(date);

     // middle info (left)
    let oldDropdown = document.querySelector(".status-update-dropdown");
    let newDropdown = oldDropdown.cloneNode(true);
    oldDropdown.replaceWith(newDropdown);

    let dropdown = newDropdown;
    dropdown.value = customerOrders[i].status;
    let prevVal = dropdown.value;
    let updatedstatus = null;

    const confirmExit = function() {
      let confirmModal = document.getElementById("confirmation");
       confirmModal.style.display = "flex";

       document.querySelector(".no").addEventListener("click", () => {
        confirmModal.style.display = "none";
        dropdown.value = prevVal;
       }) 

       document.querySelector(".confirm-modal").addEventListener("click", () => {
        confirmModal.style.display = "none";
        prevVal = updatedstatus;
        updatedstatus = null;
       })
    }

    function progressBarLogic(status, barElement) {
      let percentText = document.createElement("p");
      percentText.className = "percent-text";
      let percentage = 0;
      if(status === "not-started") {
        percentage = 0;
      } else if(status === "started") {
        percentage = 10;
      } else if (status === "in-progress") {
        percentage = 50;
      } else if (status === "ready") {
        percentage = 100;
      }
      barElement.style.width = percentage + "%";
      percentText.textContent = `${percentage}%`;
      barElement.innerHTML = "";
      barElement.appendChild(percentText);
    }

    dropdown.addEventListener("change", function() {
      let selectedVal = this.value;

      if(selectedVal === "not-started" || selectedVal === "started" || selectedVal === "in-progress" || selectedVal === "ready") {
       updatedstatus = selectedVal;
       confirmExit();
       customerOrders[i].status = selectedVal;
       progressBarLogic(selectedVal, progressBar);
        progressTrack.innerHTML = ""
        progressDisplay.textContent = `${selectedVal}`;
        progressTrack.appendChild(progressDisplay);
      }    
    })

     // middle info (right)
     let setWrapper = document.querySelector(".set-wrapper");
     setWrapper.innerHTML = "";

     let orderLabel = document.createElement("h2")
     orderLabel.className = "order-label";
     orderLabel.textContent = `${customerOrders[i].orderSet} set`;

     setWrapper.appendChild(orderLabel);

     // dropdown order-type logic
     let orderDropdown = document.querySelector(".order-type");
     let sizeForm = document.querySelector(".sizes-form");

     let gridOne = document.querySelector(".grid-box-one");
     let gridTwo = document.querySelector(".grid-box-two");
     let gridThree = document.querySelector(".grid-box-three");

     let customer = customerOrders[i];

     orderDropdown.addEventListener("change", function() {
      let selectedVal = this.value;
      let measurements = {};

      if(selectedVal === customer.order1) {
        measurements = customer.order1Measurement;
      } else if(selectedVal === customer.order2) {
        measurements = customer.order2Measurement;
      }

      gridOne.innerHTML = "";
      gridTwo.innerHTML = "";

      let keys = Object.keys(measurements);

      for(let i = 0; i < keys.length; i++) {
        let keyVal = keys[i];
        let textBox = document.createElement("input");
        textBox.type = "text";
        textBox.className = "size-input";

        textBox.value = `${keyVal}: ${measurements[keyVal]}`;

        if(i % 2 === 0) {
          gridOne.appendChild(textBox);
        } else {
          gridTwo.appendChild(textBox);
        }
      }

     })

     })

     document.querySelector(".submit-save").addEventListener("click", () => {
      customerModal.style.display = "none";
     })

    }

    // adding cashflow functions
     let tablePosition = document.querySelector(".table-position"); // parent 

     let initialTotal = document.getElementById("initial-state"); // initial

     let finalTotal = document.getElementById("total-val"); // final

     let tableBody = document.querySelector("tbody");

     let date = document.getElementById("date");
     let description = document.getElementById("description");
     let ins = document.querySelector('[data-type="in"]');
     let outs = document.querySelector('[data-type="out"]');
     let output = document.querySelector('[data-type="output"]');

     let addBtn = document.querySelector(".add-rows");

     tablePosition.addEventListener("input", function(event) {

      let prevOutput = Number(initialTotal.value); // this will be the initial output

      // this is for the added rows
      let newlyRows = document.querySelectorAll("tbody tr");

      newlyRows.forEach((row, index) => {
        let dynIns = row.querySelector('[data-type="in"]');
        let dynOuts = row.querySelector('[data-type="out"]');
        let dynOutput = row.querySelector('[data-type="output"]');

        const action = event.target.dataset.type;

        // get the current value
        let newIns = Number(dynIns.value);
        let newOuts = Number(dynOuts.value);

        dynIns.disabled = false;
        dynOuts.disabled = false;

        if(action === "in" && event.target === dynIns && dynIns.value !== "") {
          dynOuts.disabled = true;
          dynOutput.textContent = prevOutput + newIns;
        } else if (action === "out" && event.target === dynOuts && dynOuts.value !== "") {
          dynIns.disabled = true;
          dynOutput.textContent = prevOutput - newOuts;
        }

        prevOutput = Number(dynOutput.textContent);

        finalTotal.innerHTML = prevOutput;
      }); 
     });

     addBtn.addEventListener("click", function() {
      addRow();
     })
 
     // add row function
     function addRow() {
      let newRow = document.createElement("tr");

      let newDate = document.createElement("input");
      newDate.type = "date";
      newDate.className = "table-input";
      let dateTd = document.createElement("td");

      let newDescription = document.createElement("textarea");
      newDescription.className = "table-input";
      let descTd = document.createElement("td");

      let newIns = document.createElement("input");
      newIns.type = "number";
      newIns.className = "table-input";
      let insTd = document.createElement('td');
      newIns.setAttribute("data-type", "in");

      let newOuts = document.createElement("input");
      newOuts.type = "number";
      newOuts.className = "table-input";
      let outTd = document.createElement("td");
      newOuts.setAttribute("data-type", "out");

      let newOutput = document.createElement("output");
      newOutput.className = "table-input";
      let outputTd = document.createElement("td")
      newOutput.setAttribute("data-type", "output");

      dateTd.appendChild(newDate);
      descTd.appendChild(newDescription);
      insTd.appendChild(newIns);
      outTd.appendChild(newOuts);
      outputTd.appendChild(newOutput);

      newRow.appendChild(dateTd);
      newRow.appendChild(descTd);
      newRow.appendChild(insTd);
      newRow.appendChild(outTd);
      newRow.appendChild(outputTd);

      tableBody.appendChild(newRow);
       
     }

  </script>
</html>